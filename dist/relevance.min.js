/*! relevance - v2.1.0 - 2015-03-04
* https://github.com/bboyle/relevance
* Copyright (c) 2015 Ben Boyle; Licensed MIT */
"undefined"!==jQuery&&!function(a){"use strict";var b="relevant",c="irrelevant",d="button, input, select, textarea",e=function(){var b=a("<div hidden></div>"),c=b.appendTo("body").is(":hidden");return b.remove(),!c}(),f=function(b,c){return a(b.elements[c]).filter('[name="'+c+'"]')},g=function(){return 0===a(this).closest("[hidden]").length},h=function(){return a(this).closest("[hidden]").length>0},i=function(a){return a.value},j=function(b,c){var d;for("object"!=typeof b&&(b=[b]),d=0;d<c.length;d++)if(-1!==a.inArray(c[d],b))return!0;return!1},k=function(){var b=a(this.form).data("relevance").dependencyMap[this.name],c=a.map(f(this.form,this.name).filter("select,:checked").filter(":visible"),i);a.each(b,function(a,b){b.items.relevance("relevant",j(b.values,c)!==b.negate)})},l=function(b){var c,d,e;c=this.closest("form"),c.length&&(d=c.data("relevance"),"object"==typeof d&&(d=d.dependencyMap,"object"==typeof d&&(e=this.add(this.find("select,input")).filter("select,:radio,:checkbox"),e=a.unique(a.map(e,function(a){return a.name})),a.each(e,function(e,g){var h,k=d[g];"object"==typeof k&&a.each(k,function(d,e){b===!1?e.items.relevance("relevant",!1):(h=a.map(f(c[0],g).filter("select,:checked").filter(":visible"),i),e.items.relevance("relevant",j(e.values,h)!==e.negate))})}))))},m={relevant:function(a){var d;return d=a?this.filter(h).trigger(b):this.filter(g).trigger(c),d.length&&l.call(d,a),this},show:function(){return this.add(this.find(d)).not(this.find("[hidden]").find(d)).each(function(){this.removeAttribute("disabled")}),e&&this.stop(!0,!0).slideDown(),this.removeAttr("hidden").removeAttr("aria-hidden")},hide:function(){return this.attr({hidden:"hidden","aria-hidden":"true"}),e?this.stop(!0,!0).hide(0,function(){var b=a(this);b.filter(d).add(b.find(d)).each(function(){this.setAttribute("disabled","disabled")})}):this.filter(d).add(this.find(d)).each(function(){this.setAttribute("disabled","disabled")}),this},relevantWhen:function(b){var c,d,e,g;return g=b.values||[b.value],b.name?e=b.name:b.id?e=document.getElementById(b.id).name:b.container&&(e=a(b.container).find("select,:radio,:checkbox").attr("name")),b.negate=b.negate===!0,c=this.closest("form"),d=c.data("relevance"),"object"!=typeof d&&(d={},c.data("relevance",d)),"object"!=typeof d.dependencyMap&&(d.dependencyMap={}),"object"!=typeof d.dependencyMap[e]&&(d.dependencyMap[e]=[],f(c[0],e).filter(":radio,:checkbox").bind("click",k).end().filter("select").bind("change",k)),d.dependencyMap[e].push({items:this,values:g,negate:b.negate}),this.relevance("relevant",j(g,a.map(f(c[0],e).filter("select,:checked").filter(":visible"),i))!==b.negate),this},instructions:function(b){return b=a.extend({instructionSelector:".relevance",questionSelector:".questions > li"},b),this.find(b.instructionSelector).each(function(){var c,d,e,f=a(this),g=f.text(),h=f.closest(b.questionSelector),k=h.prevAll(b.questionSelector),l=!1,m=!1;if(/If different to/.test(g))l=!0,k=k.eq(0),g=k.find(":checkbox").val(),m=!0;else for(g=g.replace(/^.*chose\s+\S([^'"â€™]+)\S\s+above.*$/,"$1"),c=0;c<k.length;)d=a.map(k.eq(c).find("option,:radio,:checkbox"),i),j(g,d)?(e=k.eq(c).find(b.questionSelector),e.length?(k=a(e.get().reverse()),c=0):(l=!0,k=k.eq(c),c=1)):c++;l&&(k=k.add(k.find("select,input")).filter("select,:radio,:checkbox"),h.relevance("relevantWhen",{name:k.attr("name"),value:g,negate:m}))}),this}};a(document).bind("relevant irrelevant",function(b){var c=a(b.target);c.relevance("relevant"===b.type?"show":"hide")}),a.fn.relevance=function(b){return m[b]?m[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.relevance"):this}}(jQuery);