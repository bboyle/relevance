/*! relevance - v2.0.0 - 2015-02-26
* https://github.com/bboyle/relevance
* Copyright (c) 2015 Ben Boyle; Licensed MIT */
"undefined"!==jQuery&&!function(a){"use strict";var b="relevant",c="irrelevant",d="button, input, select, textarea",e=function(){var b=a("<div hidden/>"),c=b.appendTo("body").is(":visible");return b.remove(),c}(),f=function(b,c){return a(b.elements[c]).filter('[name="'+c+'"]')},g=function(a){return a.value},h=function(b,c){var d;for("object"!=typeof b&&(b=[b]),d=0;d<c.length;d++)if(-1!==a.inArray(c[d],b))return!0;return!1},i=function(){var b=a(this.form).data("relevance").dependencyMap[this.name],c=a.map(f(this.form,this.name).filter("select,:checked").filter(":visible"),g);a.each(b,function(a,b){b.items.relevance("relevant",h(b.values,c)!==b.negate)})},j=function(b){var c,d,e;c=this.closest("form"),c.length&&(d=c.data("relevance"),"object"==typeof d&&(d=d.dependencyMap,"object"==typeof d&&(e=this.add(this.find("select,input")).filter("select,:radio,:checkbox"),e=a.unique(a.map(e,function(a){return a.name})),a.each(e,function(e,i){var j,k=d[i];"object"==typeof k&&a.each(k,function(d,e){b===!1?e.items.relevance("relevant",!1):(j=a.map(f(c[0],i).filter("select,:checked").filter(":visible"),g),e.items.relevance("relevant",h(e.values,j)!==e.negate))})}))))},k={relevant:function(a){var d;return d=a?this.filter("[hidden]").trigger(b):this.not("[hidden]").trigger(c),d.length&&j.call(d,a),this},show:function(){return this.add(this.find(d)).not(this.find("[hidden]").find(d)).each(function(){this.removeAttribute("disabled")}),e&&this.stop(!0,!0).slideDown(),this.removeAttr("hidden").removeAttr("aria-hidden")},hide:function(){return this.attr({hidden:"hidden","aria-hidden":"true"}),e?this.stop(!0,!0).hide(0,function(){var b=a(this);b.filter(d).add(b.find(d)).each(function(){this.setAttribute("disabled","disabled")})}):this.filter(d).add(this.find(d)).each(function(){this.setAttribute("disabled","disabled")}),this},relevantWhen:function(b){var c,d,e,j;return j=b.values||[b.value],b.name?e=b.name:b.id?e=document.getElementById(b.id).name:b.container&&(e=a(b.container).find("select,:radio,:checkbox").attr("name")),b.negate=b.negate===!0,c=this.closest("form"),d=c.data("relevance"),"object"!=typeof d&&(d={},c.data("relevance",d)),"object"!=typeof d.dependencyMap&&(d.dependencyMap={}),"object"!=typeof d.dependencyMap[e]&&(d.dependencyMap[e]=[],f(c[0],e).filter(":radio,:checkbox").bind("click",i).end().filter("select").bind("change",i)),d.dependencyMap[e].push({items:this,values:j,negate:b.negate}),this.relevance("relevant",h(j,a.map(f(c[0],e).filter("select,:checked").filter(":visible"),g))!==b.negate),this},instructions:function(b){return b=a.extend({instructionSelector:".relevance",questionSelector:".questions > li"},b),this.find(b.instructionSelector).each(function(){var c,d,e=a(this),f=e.text(),i=e.closest(b.questionSelector),j=i.prevAll(b.questionSelector),k=!1,l=!1;if(/If different to/.test(f))k=!0,j=j.eq(0),f=j.find(":checkbox").val(),l=!0;else for(f=f.replace(/^.*chose\s+\S([^'"â€™]+)\S\s+above.*$/,"$1"),c=0;c<j.length;)j.eq(c).is(".section")||(d=a.map(j.eq(c).find("option,:radio,:checkbox"),g),h(f,d)&&(k=!0,j=j.eq(c))),c++;k&&(j=j.add(j.find("select,input")).filter("select,:radio,:checkbox"),i.relevance("relevantWhen",{name:j.attr("name"),value:f,negate:l}))}),this}};a(document).bind("relevant irrelevant",function(b){var c=a(b.target);c.relevance("relevant"===b.type?"show":"hide")}),a.fn.relevance=function(b){return k[b]?k[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.relevance"):this}}(jQuery);